/**
 * Created by XiTU on 1/27/14.
 */

var mysql=require('mysql');
var fs=require('fs');
var readline=require('readline');

var connection = mysql.createConnection({
                                        host: 'localhost',
                                        user: 'root',
                                        password: 'travel'
                                        });

//client.query('CREATE database sctravel');
connection.query('USE sctravel');

var rd = readline.createInterface({
                                  input: fs.createReadStream('../data/scenery_spots.dat'),
                                  output: process.stdout,
                                  terminal: false
                                  });


var processline = function(line) {
    console.log("spliting line by , ");
    var userInput = line.split(',');
    userInput[4] = Number(userInput[4]);
    userInput[5] = Number(userInput[5]);
    console.log(userInput);
    console.log("inserting into DB");
    connection.query('Insert into t_scenery_spots (' +
                     ' spot_name, spot_type, content, image, latitude, longitude, city, address, phone, hours) VALUES ' +
                     ' (?, ?, ?, ?, ?, ?, ?, ?, ?, ?) '
                     , userInput);
}

rd.on('line', function(line) {
      processline(line);
      console.log(line);
      });

rd.on('close',function(){
      connection.end();
      })
//rd.close();
//name, type, content, image, web_url, latitude, longtitude, city, address, phone, hours



