var mysql=require('mysql');

var connection = mysql.createConnection({
	host: 'localhost',
	user: 'root',
	password: 'travel'
	
});
connection.connect();
 var errorHandler = function(err) {
    console.log(err);
 }

connection.query('CREATE database sctravel',errorHandler);
connection.query('USE sctravel');

connection.query('DROP TABLE t_scenery_spots',errorHandler);
connection.query('DROP TABLE t_orders',errorHandler);
connection.query('DROP TABLE t_tickets_sold',errorHandler);


connection.query('CREATE TABLE t_scenery_spots (' +
    ' spot_id INT PRIMARY KEY AUTO_INCREMENT , ' +
    ' name VARCHAR(127) NOT NULL, ' +
    ' type VARCHAR(31), ' +
    ' content VARCHAR(127), ' +
    ' image VARCHAR(127), ' +
    ' longitude DECIMAL(20,6), ' +
    ' latitude DECIMAL(20,6), ' +
    ' city VARCHAR(63), ' +
    ' address VARCHAR(255), ' +
    ' phone VARCHAR(14),' +
    ' hours VARCHAR(31) )ENGINE=InnoDB DEFAULT CHARSET=utf8 ', errorHandler);

connection.query('CREATE TABLE t_orders ( ' +
    ' order_id INT PRIMARY KEY AUTO_INCREMENT, ' +
    ' order_status INT(1), '+
    ' email VARCHAR(63), ' +
    ' phone VARCHAR(15), ' +
    ' order_datetime TIMESTAMP DEFAULT now(), ' +
    ' last_name VARCHAR(15), ' +
    ' first_name VARCHAR(15), ' +
    ' confirmation_code VARCHAR(15) )ENGINE=InnoDB DEFAULT CHARSET=utf8  ' ,errorHandler );

connection.query('CREATE UNIQUE INDEX t_orders_IDX_0 on t_orders(confirmation_number)',errorHandler);

connection.query('CREATE TABLE t_tickets_sold (' +
    ' confirmation_code VARCHAR(15) NOT NULL, ' +
    ' spot_id INT NOT NULL, ' +
    ' valid_date DATE NOT NULL, ' +
    ' time TIME NOT NULL, ' +
    ' is_valid VARCHAR(1) DEFAULT \'Y\', ' +
    ' redeem_datetime DATE, ' +
    ' quantity INT,' +
    ' price DECIMAL(20,6) )ENGINE=InnoDB DEFAULT CHARSET=utf8  ', errorHandler);

connection.query('CREATE TABLE t_tickets_inventory ( ' +
    ' spot_id INT NOT NULL , ' +
    ' date DATE NOT NULL, ' +
    ' quantity INT , ' +
    ' price DECIMAL(20,6) )ENGINE=InnoDB DEFAULT CHARSET=utf8 ',errorHandler);


connection.end();
